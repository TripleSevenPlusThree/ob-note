/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var Mt=Object.create;var be=Object.defineProperty;var Rt=Object.getOwnPropertyDescriptor;var Wt=Object.getOwnPropertyNames;var Ot=Object.getPrototypeOf,Yt=Object.prototype.hasOwnProperty;var $t=(n,e)=>()=>(e||n((e={exports:{}}).exports,e),e.exports),Qt=(n,e)=>{for(var t in e)be(n,t,{get:e[t],enumerable:!0})},Ue=(n,e,t,s)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of Wt(e))!Yt.call(n,i)&&i!==t&&be(n,i,{get:()=>e[i],enumerable:!(s=Rt(e,i))||s.enumerable});return n};var Xe=(n,e,t)=>(t=n!=null?Mt(Ot(n)):{},Ue(e||!n||!n.__esModule?be(t,"default",{value:n,enumerable:!0}):t,n)),Zt=n=>Ue(be({},"__esModule",{value:!0}),n);var Ye=$t(f=>{"use strict";Object.defineProperty(f,"__esModule",{value:!0});var w=require("obsidian"),Be="YYYY-MM-DD",Se="gggg-[W]ww",tt="YYYY-MM",nt="YYYY-[Q]Q",st="YYYY";function te(n){let e=window.app.plugins.getPlugin("periodic-notes");return e&&e.settings?.[n]?.enabled}function ne(){try{let{internalPlugins:n,plugins:e}=window.app;if(te("daily")){let{format:r,folder:o,template:l}=e.getPlugin("periodic-notes")?.settings?.daily||{};return{format:r||Be,folder:o?.trim()||"",template:l?.trim()||""}}let{folder:t,format:s,template:i}=n.getPluginById("daily-notes")?.instance?.options||{};return{format:s||Be,folder:t?.trim()||"",template:i?.trim()||""}}catch(n){console.info("No custom daily note settings found!",n)}}function se(){try{let n=window.app.plugins,e=n.getPlugin("calendar")?.options,t=n.getPlugin("periodic-notes")?.settings?.weekly;if(te("weekly"))return{format:t.format||Se,folder:t.folder?.trim()||"",template:t.template?.trim()||""};let s=e||{};return{format:s.weeklyNoteFormat||Se,folder:s.weeklyNoteFolder?.trim()||"",template:s.weeklyNoteTemplate?.trim()||""}}catch(n){console.info("No custom weekly note settings found!",n)}}function ie(){let n=window.app.plugins;try{let e=te("monthly")&&n.getPlugin("periodic-notes")?.settings?.monthly||{};return{format:e.format||tt,folder:e.folder?.trim()||"",template:e.template?.trim()||""}}catch(e){console.info("No custom monthly note settings found!",e)}}function re(){let n=window.app.plugins;try{let e=te("quarterly")&&n.getPlugin("periodic-notes")?.settings?.quarterly||{};return{format:e.format||nt,folder:e.folder?.trim()||"",template:e.template?.trim()||""}}catch(e){console.info("No custom quarterly note settings found!",e)}}function oe(){let n=window.app.plugins;try{let e=te("yearly")&&n.getPlugin("periodic-notes")?.settings?.yearly||{};return{format:e.format||st,folder:e.folder?.trim()||"",template:e.template?.trim()||""}}catch(e){console.info("No custom yearly note settings found!",e)}}function it(...n){let e=[];for(let s=0,i=n.length;s<i;s++)e=e.concat(n[s].split("/"));let t=[];for(let s=0,i=e.length;s<i;s++){let r=e[s];!r||r==="."||t.push(r)}return e[0]===""&&t.unshift(""),t.join("/")}function Gt(n){let e=n.substring(n.lastIndexOf("/")+1);return e.lastIndexOf(".")!=-1&&(e=e.substring(0,e.lastIndexOf("."))),e}async function jt(n){let e=n.replace(/\\/g,"/").split("/");if(e.pop(),e.length){let t=it(...e);window.app.vault.getAbstractFileByPath(t)||await window.app.vault.createFolder(t)}}async function ae(n,e){e.endsWith(".md")||(e+=".md");let t=w.normalizePath(it(n,e));return await jt(t),t}async function G(n){let{metadataCache:e,vault:t}=window.app,s=w.normalizePath(n);if(s==="/")return Promise.resolve(["",null]);try{let i=e.getFirstLinkpathDest(s,""),r=await t.cachedRead(i),o=window.app.foldManager.load(i);return[r,o]}catch(i){return console.error(`Failed to read the daily note template '${s}'`,i),new w.Notice("Failed to read the daily note template"),["",null]}}function I(n,e="day"){let t=n.clone().startOf(e).format();return`${e}-${t}`}function rt(n){return n.replace(/\[[^\]]*\]/g,"")}function zt(n,e){if(e==="week"){let t=rt(n);return/w{1,2}/i.test(t)&&(/M{1,4}/.test(t)||/D{1,4}/.test(t))}return!1}function j(n,e){return ot(n.basename,e)}function Vt(n,e){return ot(Gt(n),e)}function ot(n,e){let s={day:ne,week:se,month:ie,quarter:re,year:oe}[e]().format.split("/").pop(),i=window.moment(n,s,!0);if(!i.isValid())return null;if(zt(s,e)&&e==="week"){let r=rt(s);if(/w{1,2}/i.test(r))return window.moment(n,s.replace(/M{1,4}/g,"").replace(/D{1,4}/g,""),!1)}return i}var Le=class extends Error{};async function at(n){let e=window.app,{vault:t}=e,s=window.moment,{template:i,format:r,folder:o}=ne(),[l,c]=await G(i),a=n.format(r),p=await ae(o,a);try{let A=await t.create(p,l.replace(/{{\s*date\s*}}/gi,a).replace(/{{\s*time\s*}}/gi,s().format("HH:mm")).replace(/{{\s*title\s*}}/gi,a).replace(/{{\s*(date|time)\s*(([+-]\d+)([yqmwdhs]))?\s*(:.+?)?}}/gi,(_,v,h,b,d,m)=>{let T=s(),S=n.clone().set({hour:T.get("hour"),minute:T.get("minute"),second:T.get("second")});return h&&S.add(parseInt(b,10),d),m?S.format(m.substring(1).trim()):S.format(r)}).replace(/{{\s*yesterday\s*}}/gi,n.clone().subtract(1,"day").format(r)).replace(/{{\s*tomorrow\s*}}/gi,n.clone().add(1,"d").format(r)));return e.foldManager.save(A,c),A}catch(A){console.error(`Failed to create file: '${p}'`,A),new w.Notice("Unable to create new file.")}}function Ht(n,e){return e[I(n,"day")]??null}function Ut(){let{vault:n}=window.app,{folder:e}=ne(),t=n.getAbstractFileByPath(w.normalizePath(e));if(!t)throw new Le("Failed to find daily notes folder");let s={};return w.Vault.recurseChildren(t,i=>{if(i instanceof w.TFile){let r=j(i,"day");if(r){let o=I(r,"day");s[o]=i}}}),s}var Me=class extends Error{};function Xt(){let{moment:n}=window,e=n.localeData()._week.dow,t=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"];for(;e;)t.push(t.shift()),e--;return t}function Jt(n){return Xt().indexOf(n.toLowerCase())}async function lt(n){let{vault:e}=window.app,{template:t,format:s,folder:i}=se(),[r,o]=await G(t),l=n.format(s),c=await ae(i,l);try{let a=await e.create(c,r.replace(/{{\s*(date|time)\s*(([+-]\d+)([yqmwdhs]))?\s*(:.+?)?}}/gi,(p,A,_,v,h,b)=>{let d=window.moment(),m=n.clone().set({hour:d.get("hour"),minute:d.get("minute"),second:d.get("second")});return _&&m.add(parseInt(v,10),h),b?m.format(b.substring(1).trim()):m.format(s)}).replace(/{{\s*title\s*}}/gi,l).replace(/{{\s*time\s*}}/gi,window.moment().format("HH:mm")).replace(/{{\s*(sunday|monday|tuesday|wednesday|thursday|friday|saturday)\s*:(.*?)}}/gi,(p,A,_)=>{let v=Jt(A);return n.weekday(v).format(_.trim())}));return window.app.foldManager.save(a,o),a}catch(a){console.error(`Failed to create file: '${c}'`,a),new w.Notice("Unable to create new file.")}}function qt(n,e){return e[I(n,"week")]??null}function Kt(){let n={};if(!ut())return n;let{vault:e}=window.app,{folder:t}=se(),s=e.getAbstractFileByPath(w.normalizePath(t));if(!s)throw new Me("Failed to find weekly notes folder");return w.Vault.recurseChildren(s,i=>{if(i instanceof w.TFile){let r=j(i,"week");if(r){let o=I(r,"week");n[o]=i}}}),n}var Re=class extends Error{};async function ct(n){let{vault:e}=window.app,{template:t,format:s,folder:i}=ie(),[r,o]=await G(t),l=n.format(s),c=await ae(i,l);try{let a=await e.create(c,r.replace(/{{\s*(date|time)\s*(([+-]\d+)([yqmwdhs]))?\s*(:.+?)?}}/gi,(p,A,_,v,h,b)=>{let d=window.moment(),m=n.clone().set({hour:d.get("hour"),minute:d.get("minute"),second:d.get("second")});return _&&m.add(parseInt(v,10),h),b?m.format(b.substring(1).trim()):m.format(s)}).replace(/{{\s*date\s*}}/gi,l).replace(/{{\s*time\s*}}/gi,window.moment().format("HH:mm")).replace(/{{\s*title\s*}}/gi,l));return window.app.foldManager.save(a,o),a}catch(a){console.error(`Failed to create file: '${c}'`,a),new w.Notice("Unable to create new file.")}}function en(n,e){return e[I(n,"month")]??null}function tn(){let n={};if(!dt())return n;let{vault:e}=window.app,{folder:t}=ie(),s=e.getAbstractFileByPath(w.normalizePath(t));if(!s)throw new Re("Failed to find monthly notes folder");return w.Vault.recurseChildren(s,i=>{if(i instanceof w.TFile){let r=j(i,"month");if(r){let o=I(r,"month");n[o]=i}}}),n}var We=class extends Error{};async function nn(n){let{vault:e}=window.app,{template:t,format:s,folder:i}=re(),[r,o]=await G(t),l=n.format(s),c=await ae(i,l);try{let a=await e.create(c,r.replace(/{{\s*(date|time)\s*(([+-]\d+)([yqmwdhs]))?\s*(:.+?)?}}/gi,(p,A,_,v,h,b)=>{let d=window.moment(),m=n.clone().set({hour:d.get("hour"),minute:d.get("minute"),second:d.get("second")});return _&&m.add(parseInt(v,10),h),b?m.format(b.substring(1).trim()):m.format(s)}).replace(/{{\s*date\s*}}/gi,l).replace(/{{\s*time\s*}}/gi,window.moment().format("HH:mm")).replace(/{{\s*title\s*}}/gi,l));return window.app.foldManager.save(a,o),a}catch(a){console.error(`Failed to create file: '${c}'`,a),new w.Notice("Unable to create new file.")}}function sn(n,e){return e[I(n,"quarter")]??null}function rn(){let n={};if(!mt())return n;let{vault:e}=window.app,{folder:t}=re(),s=e.getAbstractFileByPath(w.normalizePath(t));if(!s)throw new We("Failed to find quarterly notes folder");return w.Vault.recurseChildren(s,i=>{if(i instanceof w.TFile){let r=j(i,"quarter");if(r){let o=I(r,"quarter");n[o]=i}}}),n}var Oe=class extends Error{};async function on(n){let{vault:e}=window.app,{template:t,format:s,folder:i}=oe(),[r,o]=await G(t),l=n.format(s),c=await ae(i,l);try{let a=await e.create(c,r.replace(/{{\s*(date|time)\s*(([+-]\d+)([yqmwdhs]))?\s*(:.+?)?}}/gi,(p,A,_,v,h,b)=>{let d=window.moment(),m=n.clone().set({hour:d.get("hour"),minute:d.get("minute"),second:d.get("second")});return _&&m.add(parseInt(v,10),h),b?m.format(b.substring(1).trim()):m.format(s)}).replace(/{{\s*date\s*}}/gi,l).replace(/{{\s*time\s*}}/gi,window.moment().format("HH:mm")).replace(/{{\s*title\s*}}/gi,l));return window.app.foldManager.save(a,o),a}catch(a){console.error(`Failed to create file: '${c}'`,a),new w.Notice("Unable to create new file.")}}function an(n,e){return e[I(n,"year")]??null}function ln(){let n={};if(!ft())return n;let{vault:e}=window.app,{folder:t}=oe(),s=e.getAbstractFileByPath(w.normalizePath(t));if(!s)throw new Oe("Failed to find yearly notes folder");return w.Vault.recurseChildren(s,i=>{if(i instanceof w.TFile){let r=j(i,"year");if(r){let o=I(r,"year");n[o]=i}}}),n}function cn(){let{app:n}=window,e=n.internalPlugins.plugins["daily-notes"];if(e&&e.enabled)return!0;let t=n.plugins.getPlugin("periodic-notes");return t&&t.settings?.daily?.enabled}function ut(){let{app:n}=window;if(n.plugins.getPlugin("calendar"))return!0;let e=n.plugins.getPlugin("periodic-notes");return e&&e.settings?.weekly?.enabled}function dt(){let{app:n}=window,e=n.plugins.getPlugin("periodic-notes");return e&&e.settings?.monthly?.enabled}function mt(){let{app:n}=window,e=n.plugins.getPlugin("periodic-notes");return e&&e.settings?.quarterly?.enabled}function ft(){let{app:n}=window,e=n.plugins.getPlugin("periodic-notes");return e&&e.settings?.yearly?.enabled}function un(n){let e={day:ne,week:se,month:ie,quarter:re,year:oe}[n];return e()}function dn(n,e){return{day:at,month:ct,week:lt}[n](e)}f.DEFAULT_DAILY_NOTE_FORMAT=Be;f.DEFAULT_MONTHLY_NOTE_FORMAT=tt;f.DEFAULT_QUARTERLY_NOTE_FORMAT=nt;f.DEFAULT_WEEKLY_NOTE_FORMAT=Se;f.DEFAULT_YEARLY_NOTE_FORMAT=st;f.appHasDailyNotesPluginLoaded=cn;f.appHasMonthlyNotesPluginLoaded=dt;f.appHasQuarterlyNotesPluginLoaded=mt;f.appHasWeeklyNotesPluginLoaded=ut;f.appHasYearlyNotesPluginLoaded=ft;f.createDailyNote=at;f.createMonthlyNote=ct;f.createPeriodicNote=dn;f.createQuarterlyNote=nn;f.createWeeklyNote=lt;f.createYearlyNote=on;f.getAllDailyNotes=Ut;f.getAllMonthlyNotes=tn;f.getAllQuarterlyNotes=rn;f.getAllWeeklyNotes=Kt;f.getAllYearlyNotes=ln;f.getDailyNote=Ht;f.getDailyNoteSettings=ne;f.getDateFromFile=j;f.getDateFromPath=Vt;f.getDateUID=I;f.getMonthlyNote=en;f.getMonthlyNoteSettings=ie;f.getPeriodicNoteSettings=un;f.getQuarterlyNote=sn;f.getQuarterlyNoteSettings=re;f.getTemplateInfo=G;f.getWeeklyNote=qt;f.getWeeklyNoteSettings=se;f.getYearlyNote=an;f.getYearlyNoteSettings=oe});var Nn={};Qt(Nn,{default:()=>Fe});module.exports=Zt(Nn);var St=require("obsidian");var D=require("obsidian");var ye=class{constructor(){this.customFolder="Day Planners";this.mode=0;this.mermaid=!1;this.notesToDates=[];this.completePastItems=!0;this.circularProgress=!1;this.nowAndNextInStatusBar=!1;this.showTaskNotification=!1;this.timelineZoomLevel=4;this.timelineIcon="calendar-with-checkmark";this.plannerLabel="Day Planner";this.breakLabel="BREAK";this.endLabel="END";this.markCurrent=!1;this.correctLabels=!0;this.writer=void 0}},Y=class{constructor(e,t){this.notePath=e,this.date=t}},M=class{exists(e){return e&&this.active(e)!==void 0}active(e){let t=new Date().toDateString();return e&&e.filter(s=>s.date===t)[0]}},N=(s=>(s[s.File=0]="File",s[s.Command=1]="Command",s[s.Daily=2]="Daily",s))(N||{});var Je="YYYYMMDD",qe=/(?<target>{{date:?(?<date>[^}]*)}})/g,Ke="Day Planner-{{date}}.md",_e=`## Day Planner
- [ ] `,$="timeline";var et=["any-key","audio-file","blocks","broken-link","bullet-list","calendar-with-checkmark","checkmark","create-new","cross","cross-in-box","crossed-star","dice","document","documents","dot-network","enter","expand-vertically","filled-pin","folder","gear","go-to-file","hashtag","help","horizontal-split","image-file","info","install","languages","left-arrow","left-arrow-with-tail","lines-of-text","link","logo-crystal","magnifying-glass","microphone","microphone-filled","open-vault","pane-layout","paper-plane","pdf-file","pencil","pin","popup-open","presentation","reset","right-arrow","right-arrow-with-tail","right-triangle","search","sheets-in-box","star","star-list","switch","three-horizontal-bars","trash","two-columns","up-and-down-arrows","uppercase-lowercase-a","vault","vertical-split","vertical-three-dots"];var W=class{replace(e){let t=qe,s=e,i=[],r;for(;r=t.exec(s);)i.push(r);if(!i||i.length===0)return e;let o=new Date,l=i.map(a=>{let p=a.groups.date===""?Je:a.groups.date;return[a.groups.target,this.getMoment(o,p)]}),c=s;return l.forEach(a=>{c=c.replace(a[0],a[1])}),c}getMoment(e,t){return window.moment,window.moment(e).format(t)}};var we=class extends D.PluginSettingTab{constructor(t,s){super(t,s);this.momentDateRegex=new W;this.plugin=s}display(){let{containerEl:t}=this;t.empty(),new D.Setting(t).setName("Day Planner mode").setDesc(this.modeDescriptionContent()).addDropdown(s=>s.addOption(N[0],"File mode").addOption(N[1],"Command mode").addOption(N[2],"Daily mode").setValue(N[this.plugin.settings.mode]||0 .toString()).onChange(i=>{this.plugin.settings.mode=N[i],this.plugin.saveData(this.plugin.settings)})),new D.Setting(t).setName("Complete past planner items").setDesc("The plugin will automatically mark checkboxes for tasks and breaks in the past as complete (x)").addToggle(s=>s.setValue(this.plugin.settings.completePastItems).onChange(i=>{this.plugin.settings.completePastItems=i,this.plugin.saveData(this.plugin.settings)})),new D.Setting(t).setName("Mark in progress planner item").setDesc("The plugin will automatically mark the textbox for the current item as in progress (/)").addToggle(s=>s.setValue(this.plugin.settings.markCurrent).onChange(i=>{this.plugin.settings.markCurrent=i,this.plugin.saveData(this.plugin.settings)})),new D.Setting(t).setName("Status bar - circular progress").setDesc("Display a circular progress bar in the status bar").addToggle(s=>s.setValue(this.plugin.settings.circularProgress).onChange(i=>{this.plugin.settings.circularProgress=i,this.plugin.saveData(this.plugin.settings)})),new D.Setting(t).setName("Status bar - now and next").setDesc("Display now and next tasks in the status bar").addToggle(s=>s.setValue(this.plugin.settings.nowAndNextInStatusBar).onChange(i=>{this.plugin.settings.nowAndNextInStatusBar=i,this.plugin.saveData(this.plugin.settings)})),new D.Setting(t).setName("Task notification").setDesc("Display a notification when a new task is started").addToggle(s=>s.setValue(this.plugin.settings.showTaskNotification).onChange(i=>{this.plugin.settings.showTaskNotification=i,this.plugin.saveData(this.plugin.settings)})),new D.Setting(t).setName("Timeline zoom level").setDesc("The zoom level to display the timeline. The higher the number, the more vertical space each task will take up.").addSlider(s=>s.setLimits(1,5,1).setValue(this.plugin.settings.timelineZoomLevel??4).setDynamicTooltip().onChange(i=>{this.plugin.settings.timelineZoomLevel=i,this.plugin.saveData(this.plugin.settings)})),new D.Setting(t).setName("Timeline icon").setDesc("The icon of the timeline pane. Reopen timeline pane or restart obsidian to see the change.").addDropdown(s=>(et.forEach(i=>s.addOption(i,i)),s.setValue(this.plugin.settings.timelineIcon??"calendar-with-checkmark").onChange(i=>{this.plugin.settings.timelineIcon=i,this.plugin.saveData(this.plugin.settings)}))),new D.Setting(t).setName("Day Planner heading").setDesc("Use this heading text to mark the beginning of the Day Planner.").addText(s=>s.setValue(this.plugin.settings.plannerLabel??"Day Planner").onChange(i=>{i=i.trim(),i.length>0&&(this.plugin.settings.plannerLabel=i,this.plugin.saveData(this.plugin.settings))})),new D.Setting(t).setName("BREAK task label").setDesc("Use this label to mark break between tasks.").addText(s=>s.setValue(this.plugin.settings.breakLabel??"BREAK").onChange(i=>{this.plugin.settings.breakLabel=i,this.plugin.saveData(this.plugin.settings)})),new D.Setting(t).setName("END task label").setDesc("Use this label to mark the end of all tasks.").addText(s=>s.setValue(this.plugin.settings.endLabel??"END").onChange(i=>{this.plugin.settings.endLabel=i,this.plugin.saveData(this.plugin.settings)})),new D.Setting(t).setName("Consistent BREAK and END labels").setDesc("Replace BREAK and END task text in your planner with the configured label text (consistency)").addToggle(s=>s.setValue(this.plugin.settings.correctLabels).onChange(i=>{this.plugin.settings.correctLabels=i,this.plugin.saveData(this.plugin.settings)}))}modeDescriptionContent(){let t=document.createDocumentFragment();return t.appendText("Choose between 3 modes to use the Day Planner plugin:"),t.appendChild(document.createElement("br")),t.appendChild(document.createElement("strong")).appendText("File mode"),t.appendChild(document.createElement("br")),t.appendText("Plugin automatically generates day planner notes for each day within a Day Planners folder."),t.appendChild(document.createElement("br")),t.appendChild(document.createElement("strong")).appendText("Command mode"),t.appendChild(document.createElement("br")),t.appendText("Command used to insert a Day Planner for today within the current note."),t.appendChild(document.createElement("br")),t.appendChild(document.createElement("strong")).appendText("Daily mode"),t.appendChild(document.createElement("br")),t.appendText("Plugin automatically links to the current daily note. Daily notes plugin must be enabled."),t.appendChild(document.createElement("br")),this.addDocsLink(t),t}addDocsLink(t){let s=document.createElement("a");s.href="https://github.com/ebullient/obsidian-day-planner-og/blob/main/README.md",s.text="plugin README",s.target="_blank",t.appendChild(s),t.appendChild(document.createElement("br"))}};var K=class{constructor(e,t,s,i,r,o){this.settings=e,this.statusBar=t,this.workspace=s,this.progress=i,this.plannerMD=r,this.file=o}initStatusBar(){if(this.statusBarAdded)return;let e=this.statusBar.createEl("div",{cls:"day-planner",title:"View the Day Planner",prepend:!0});this.setupCard(e),this.statusBarText=e.createEl("span",{cls:["status-bar-item-segment","day-planner-status-bar-text"]}),this.setupCircularProgressBar(e),this.setupHorizontalProgressBar(e),this.nextText=e.createEl("span",{cls:["status-bar-item-segment","day-planner-status-bar-text"]}),this.setupStatusBarEvents(e),this.statusBarAdded=!0}setupStatusBarEvents(e){e.onClickEvent(async t=>{try{let s=this.file.todayPlannerFilePath();this.workspace.openLinkText(s,"",!1)}catch(s){console.log(s)}}),e.on("mouseenter",".day-planner",()=>{this.show(this.card)}),e.on("mouseleave",".day-planner",()=>{this.hide(this.card)})}async refreshStatusBar(e){return!e.empty&&!e.invalid?(this.updateProgress(e.current,e.next),this.show(this.statusBar)):this.hide(this.statusBar),e}hide(e){e&&(e.style.display="none")}show(e){e&&(e.style.display="block")}hideProgress(){this.hide(this.statusBarProgress),this.hide(this.circle),this.hide(this.nextText)}updateProgress(e,t){if(!e||!t||e.isEnd){this.hideProgress(),this.statusBarText.innerText=this.settings.endLabel;return}let{percentageComplete:s,minsUntilNext:i}=this.progress.getProgress(e,t);this.settings.circularProgress?(this.hide(this.statusBarProgress),this.progressCircle(s,e)):(this.hide(this.circle),this.progressBar(s,e)),this.statusText(i,e,t,s)}progressBar(e,t){t.isBreak?this.statusBarCurrentProgress.addClass("green"):this.statusBarCurrentProgress.removeClass("green"),this.statusBarCurrentProgress.style.width=`${e}%`,this.show(this.statusBarProgress)}progressCircle(e,t){t.isBreak?this.circle.addClass("green"):this.circle.removeClass("green"),this.circle.setAttr("data-value",e.toFixed(0)),this.show(this.circle)}statusText(e,t,s,i){e=e==="0"?"1":e;let r=`${e} min${e==="1"?"":"s"}`;if(this.settings.nowAndNextInStatusBar)this.statusBarText.innerHTML=`<strong>Now</strong> ${t.rawTime} ${this.ellipsis(t.text,10)}`,this.nextText.innerHTML=`<strong>Next</strong> ${s.rawTime} ${this.ellipsis(s.text,10)}`,this.show(this.nextText);else{this.hide(this.nextText);let p=t.isBreak?`${this.settings.breakLabel} for ${r}`:`${r} left`;this.statusBarText.innerText=p}let o=`Current Task (${i.toFixed(0)}% complete)`,l=`${t.rawTime} ${t.text}`,c=`Next Task (in ${r})`,a=`${s.rawTime} ${s.text}`;this.cardCurrent.innerHTML=`<strong>${o}</strong><br> ${l}`,this.cardNext.innerHTML=`<strong>${c}</strong><br> ${a}`,this.taskNotification(t,l,c,a)}taskNotification(e,t,s,i){this.settings.showTaskNotification&&this.currentTime!==void 0&&this.currentTime!==e.time.toUTCString()&&new Notification(`Task started, ${t}`,{body:`${s}: ${i}`,requireInteraction:!0}),this.currentTime=e.time.toUTCString()}ellipsis(e,t){return e.length<=t?e:e.substring(0,t)+"..."}setupHorizontalProgressBar(e){this.statusBarProgress=e.createEl("div",{cls:["status-bar-item-segment","day-planner-progress-bar"]}),this.statusBarProgress.style.display="none",this.statusBarCurrentProgress=this.statusBarProgress.createEl("div",{cls:"day-planner-progress-value"})}setupCircularProgressBar(e){this.circle=e.createEl("div",{cls:["status-bar-item-segment","progress-pie day-planner"]})}setupCard(e){this.card=e.createEl("div",{cls:"day-planner-status-card"}),this.cardCurrent=this.card.createEl("span"),this.card.createEl("br"),this.card.createEl("br"),this.cardNext=this.card.createEl("span"),this.card.createEl("div",{cls:"arrow-down"})}};var Q=window.moment,ee=class{getProgress(e,t){try{let i=Q(new Date),r=Q(e.time),o=Q(t.time),l=Q.duration(o.diff(r)),c=Q.duration(i.diff(r)),a=Q.duration(o.diff(i)),p=c.asMinutes()/l.asMinutes()*100,A=a.asMinutes().toFixed(0);return{percentageComplete:p,minsUntilNext:A}}catch(s){console.log(s)}}progressMarkdown(e,t){try{let{percentageComplete:s}=this.getProgress(e,t),i=Math.floor(20*(s/100));return new Array(i).join("->")+new Array(20-i).join("_ ")}catch(s){console.log(s)}}};var Ne=require("obsidian");var B=class{constructor(e,t){this.iAmWriter=t,this.empty=e.length<1,this.invalid=!1,this.items=e,this.past=[]}addItem(e){this.items.push(e),this.empty=!1}calculate(e){try{if(this.items.length===0){this.empty=!0;return}this.items.forEach((t,s)=>{let i=this.items[s+1];if(t.time<e&&(t.isEnd||i&&e<i.time)?(this.current=t,t.isEnd&&(t.isPast=!0,this.past.push(t)),this.next=t.isEnd?null:i):t.time<e&&(t.isPast=!0,this.past.push(t)),i){let r=window.moment,o=r.duration(r(i.time).diff(r(t.time))).asMinutes();t.durationMins=o}})}catch(t){console.log(t)}}isCurrent(e){return e==this.current}},Te=class{constructor(e,t,s,i,r,o,l,c,a){this.line=e,this.charIndex=t,this.status=s,this.isBreak=i,this.isEnd=r,this.time=o,this.rawTime=l,this.text=c,this.raw=a}},ve=class{constructor(e){this.settings=e}getPlanItem(e,t,s,i,r,o,l,c,a){let p=this.getDisplayText(i,r,c);return new Te(e,t,s,i,r,o,l,p,a)}getDisplayText(e,t,s){return e&&this.settings.correctLabels?this.settings.breakLabel:t&&this.settings.correctLabels?this.settings.endLabel:s}};var Z=class{constructor(e,t,s,i,r){this.workspace=e,this.settings=t,this.file=s,this.parser=i,this.progress=r,this.noteForDateQuery=new M}async insertPlanner(){let e=this.file.todayPlannerFilePath(),s=this.workspace.getActiveViewOfType(Ne.MarkdownView).editor.getCursor().line;await this.file.processFile(e,i=>{let r=i.split(`
`);return[...r.slice(0,s),..._e.split(`
`),...r.slice(s)].join(`
`)})}async processDayPlanner(e){try{await this.file.prepareFile();let t=this.file.todayPlannerFilePath(),s=new B([],e),i=new Date;return await this.file.processFile(t,r=>this.parser.parseContent(r,s,i)),s}catch(t){console.log(t)}}checkIsDayPlannerEditing(){let e=this.workspace.getActiveViewOfType(Ne.MarkdownView);if(e==null)return;let t=e.getState(),s=this.file.todayPlannerFilePath();s&&t.file===s&&(this.dayPlannerLastEdit=new Date().getTime())}};var Ee=require("obsidian");var Ce=Xe(Ye()),le=class{constructor(e,t){this.vault=e,this.settings=t,this.momentDateRegex=new W,this.noteForDateQuery=new M}async hasTodayNote(){if(this.settings.mode==2&&(0,Ce.appHasDailyNotesPluginLoaded)()){let e=new Date,{folder:t,format:s}=(0,Ce.getDailyNoteSettings)(),i=this.momentDateRegex.getMoment(e,s)+".md",r=(0,Ee.normalizePath)(t+"/"+i);if(await this.vault.adapter.exists(r)){let o=new Y(r,e.toDateString());return this.settings.notesToDates=[o],!0}return!1}return this.settings.mode===0||this.noteForDateQuery.exists(this.settings.notesToDates)}todayPlannerFilePath(){if(this.settings.mode===1||this.settings.mode===2)return this.noteForDateQuery.active(this.settings.notesToDates)?.notePath;let e=this.todayPlannerFileName();return`${this.settings.customFolder??"Day Planners"}/${e}`}todayPlannerFileName(){return this.momentDateRegex.replace(Ke)}async prepareFile(){try{this.settings.mode===0&&(await this.createFolderIfNotExists(this.settings.customFolder),await this.createFileIfNotExists(this.todayPlannerFilePath()))}catch(e){console.log(e)}}async createFolderIfNotExists(e){try{let t=(0,Ee.normalizePath)(e);await this.vault.adapter.exists(t,!1)||await this.vault.createFolder(t)}catch(t){console.log(t)}}async createFileIfNotExists(e){try{let t=(0,Ee.normalizePath)(e);await this.vault.adapter.exists(t,!1)||await this.vault.create(t,_e)}catch(t){console.log(t)}}async processFile(e,t){try{return await this.vault.adapter.process(e,t)}catch(s){console.log(s)}}};var ce=class{constructor(e){this.updateSettings(e),this.PLAN_PARSER_REGEX=new RegExp("^(-?[\\s]*\\[?(?<completion>.)\\]\\s*?(?<hours>\\d{1,2}):(?<minutes>\\d{2})\\s(?<text>.*?))$","i")}updateSettings(e){this.settings=e,this.planItemFactory=new ve(e),this.PLAN_START=`# ${this.settings.plannerLabel}`,this.PLAN_BREAK=new RegExp(`(?<=^|\\s)${e.breakLabel}(?=\\s|$)`),this.PLAN_END=new RegExp(`(?<=^|\\s)${e.endLabel}(?=\\s|$)`)}parseContent(e,t,s){let i=!1,r=e.split(`
`);return r.forEach((o,l)=>{if(o.length!=0)if(i){if(o=="---"){i=!1;return}let c=this.parseLine(l,o);c&&(t.addItem(c),i=!c.isEnd)}else o.trim().endsWith(this.PLAN_START)&&(i=!0)}),t.calculate(s),!t.empty&&t.iAmWriter&&t.items.forEach(o=>{let l=this.updateItemCompletion(o,t);r[o.line]=l}),r.join(`
`)}parseLine(e,t){try{let s=this.PLAN_PARSER_REGEX.exec(t);if(s){let i=s,r=i.groups.text,o=this.matches(r,this.PLAN_BREAK),l=this.matches(r,this.PLAN_END),c=new Date;return c.setHours(parseInt(i.groups.hours)),c.setMinutes(parseInt(i.groups.minutes)),c.setSeconds(0),this.planItemFactory.getPlanItem(e,i.index,i.groups.completion,o,l,c,`${i.groups.hours.padStart(2,"0")}:${i.groups.minutes}`,r,i[0])}}catch(s){console.log(s)}}updateItemCompletion(e,t){let s=e.status;return this.settings.completePastItems&&(e.isPast?s=s=="-"?"-":"x":this.settings.markCurrent&&t.isCurrent(e)?s="/":s=" "),`- [${s}] ${e.rawTime} ${e.text}`}matches(e,t){return t.test(e.trim().toUpperCase())}};var Bt=require("obsidian");function k(){}function je(n){return n()}function pt(){return Object.create(null)}function U(n){n.forEach(je)}function de(n){return typeof n=="function"}function De(n,e){return n!=n?e==e:n!==e||n&&typeof n=="object"||typeof n=="function"}function ht(n){return Object.keys(n).length===0}var bt=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global,Qe=class n{constructor(e){this.options=e,this._listeners="WeakMap"in bt?new WeakMap:void 0}observe(e,t){return this._listeners.set(e,t),this._getObserver().observe(e,this.options),()=>{this._listeners.delete(e),this._observer.unobserve(e)}}_getObserver(){var e;return(e=this._observer)!==null&&e!==void 0?e:this._observer=new ResizeObserver(t=>{var s;for(let i of t)n.entries.set(i.target,i),(s=this._listeners.get(i.target))===null||s===void 0||s(i)})}};Qe.entries="WeakMap"in bt?new WeakMap:void 0;var yt=!1;function mn(){yt=!0}function fn(){yt=!1}function y(n,e){n.appendChild(e)}function _t(n,e,t){let s=pn(n);if(!s.getElementById(e)){let i=E("style");i.id=e,i.textContent=t,An(s,i)}}function pn(n){if(!n)return document;let e=n.getRootNode?n.getRootNode():n.ownerDocument;return e&&e.host?e:n.ownerDocument}function An(n,e){return y(n.head||n,e),e.sheet}function fe(n,e,t){n.insertBefore(e,t||null)}function X(n){n.parentNode&&n.parentNode.removeChild(n)}function wt(n,e){for(let t=0;t<n.length;t+=1)n[t]&&n[t].d(e)}function E(n){return document.createElement(n)}function J(n){return document.createTextNode(n)}function R(){return J(" ")}function vt(){return J("")}function Et(n,e,t,s){return n.addEventListener(e,t,s),()=>n.removeEventListener(e,t,s)}function g(n,e,t){t==null?n.removeAttribute(e):n.getAttribute(e)!==t&&n.setAttribute(e,t)}function gn(n){return Array.from(n.childNodes)}function xe(n,e){e=""+e,n.data!==e&&(n.data=e)}function F(n,e,t,s){t==null?n.style.removeProperty(e):n.style.setProperty(e,t,s?"important":"")}var me;function ue(n){me=n}function Ct(){if(!me)throw new Error("Function called outside component initialization");return me}function ze(n){Ct().$$.on_mount.push(n)}function O(n){Ct().$$.on_destroy.push(n)}var V=[];var At=[],H=[],gt=[],hn=Promise.resolve(),Ze=!1;function bn(){Ze||(Ze=!0,hn.then(Pt))}function Ge(n){H.push(n)}var $e=new Set,z=0;function Pt(){if(z!==0)return;let n=me;do{try{for(;z<V.length;){let e=V[z];z++,ue(e),yn(e.$$)}}catch(e){throw V.length=0,z=0,e}for(ue(null),V.length=0,z=0;At.length;)At.pop()();for(let e=0;e<H.length;e+=1){let t=H[e];$e.has(t)||($e.add(t),t())}H.length=0}while(V.length);for(;gt.length;)gt.pop()();Ze=!1,$e.clear(),ue(n)}function yn(n){if(n.fragment!==null){n.update(),U(n.before_update);let e=n.dirty;n.dirty=[-1],n.fragment&&n.fragment.p(n.ctx,e),n.after_update.forEach(Ge)}}function _n(n){let e=[],t=[];H.forEach(s=>n.indexOf(s)===-1?e.push(s):t.push(s)),t.forEach(s=>s()),H=e}var wn=new Set;function vn(n,e){n&&n.i&&(wn.delete(n),n.i(e))}var En=["allowfullscreen","allowpaymentrequest","async","autofocus","autoplay","checked","controls","default","defer","disabled","formnovalidate","hidden","inert","ismap","loop","multiple","muted","nomodule","novalidate","open","playsinline","readonly","required","reversed","selected"],us=new Set([...En]);function Cn(n,e,t,s){let{fragment:i,after_update:r}=n.$$;i&&i.m(e,t),s||Ge(()=>{let o=n.$$.on_mount.map(je).filter(de);n.$$.on_destroy?n.$$.on_destroy.push(...o):U(o),n.$$.on_mount=[]}),r.forEach(Ge)}function Dt(n,e){let t=n.$$;t.fragment!==null&&(_n(t.after_update),U(t.on_destroy),t.fragment&&t.fragment.d(e),t.on_destroy=t.fragment=null,t.ctx=[])}function Pn(n,e){n.$$.dirty[0]===-1&&(V.push(n),bn(),n.$$.dirty.fill(0)),n.$$.dirty[e/31|0]|=1<<e%31}function xt(n,e,t,s,i,r,o,l=[-1]){let c=me;ue(n);let a=n.$$={fragment:null,ctx:[],props:r,update:k,not_equal:i,bound:pt(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(c?c.$$.context:[])),callbacks:pt(),dirty:l,skip_bound:!1,root:e.target||c.$$.root};o&&o(a.root);let p=!1;if(a.ctx=t?t(n,e.props||{},(A,_,...v)=>{let h=v.length?v[0]:_;return a.ctx&&i(a.ctx[A],a.ctx[A]=h)&&(!a.skip_bound&&a.bound[A]&&a.bound[A](h),p&&Pn(n,A)),_}):[],a.update(),p=!0,U(a.before_update),a.fragment=s?s(a.ctx):!1,e.target){if(e.hydrate){mn();let A=gn(e.target);a.fragment&&a.fragment.l(A),A.forEach(X)}else a.fragment&&a.fragment.c();e.intro&&vn(n.$$.fragment),Cn(n,e.target,e.anchor,e.customElement),fn(),Pt()}ue(c)}var Dn;typeof HTMLElement=="function"&&(Dn=class extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){let{on_mount:n}=this.$$;this.$$.on_disconnect=n.map(je).filter(de);for(let e in this.$$.slotted)this.appendChild(this.$$.slotted[e])}attributeChangedCallback(n,e,t){this[n]=t}disconnectedCallback(){U(this.$$.on_disconnect)}$destroy(){Dt(this,1),this.$destroy=k}$on(n,e){if(!de(e))return k;let t=this.$$.callbacks[n]||(this.$$.callbacks[n]=[]);return t.push(e),()=>{let s=t.indexOf(e);s!==-1&&t.splice(s,1)}}$set(n){this.$$set&&!ht(n)&&(this.$$.skip_bound=!0,this.$$set(n),this.$$.skip_bound=!1)}});var Pe=class{$destroy(){Dt(this,1),this.$destroy=k}$on(e,t){if(!de(t))return k;let s=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return s.push(t),()=>{let i=s.indexOf(t);i!==-1&&s.splice(i,1)}}$set(e){this.$$set&&!ht(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}};var q=[];function pe(n,e=k){let t,s=new Set;function i(l){if(De(n,l)&&(n=l,t)){let c=!q.length;for(let a of s)a[1](),q.push(a,n);if(c){for(let a=0;a<q.length;a+=2)q[a][0](q[a+1]);q.length=0}}}function r(l){i(l(n))}function o(l,c=k){let a=[l,c];return s.add(a),s.size===1&&(t=e(i)||k),l(n),()=>{s.delete(a),s.size===0&&t&&(t(),t=null)}}return{set:i,update:r,subscribe:o}}var Ae=pe(new B([],!1)),ge=pe(0),ke=pe(new Date),Ie=pe(4);function xn(n){_t(n,"svelte-1ebb1rm",'#day-planner-timeline-container.svelte-1ebb1rm.svelte-1ebb1rm{position:relative;--skobeloff:#006466ff;--midnight-green-eagle-green:#065a60ff;--midnight-green-eagle-green-2:#0b525bff;--midnight-green-eagle-green-3:#144552ff;--charcoal:#1b3a4bff;--prussian-blue:#212f45ff;--space-cadet:#272640ff;--dark-purple:#312244ff;--russian-violet:#3e1f47ff;--russian-violet-2:#4d194dff}.aside.svelte-1ebb1rm.svelte-1ebb1rm{position:absolute;top:-1px;left:0;width:65px;height:100%;background-repeat:repeat-y;opacity:80%}.aside-x5.svelte-1ebb1rm.svelte-1ebb1rm{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABYAAAEsCAYAAADHIkNEAAAAAXNSR0IArs4c6QAAAFBlWElmTU0AKgAAAAgAAgESAAMAAAABAAEAAIdpAAQAAAABAAAAJgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAFqADAAQAAAABAAABLAAAAAAuMW7GAAABWWlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iWE1QIENvcmUgNS40LjAiPgogICA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPgogICAgICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIgogICAgICAgICAgICB4bWxuczp0aWZmPSJodHRwOi8vbnMuYWRvYmUuY29tL3RpZmYvMS4wLyI+CiAgICAgICAgIDx0aWZmOk9yaWVudGF0aW9uPjE8L3RpZmY6T3JpZW50YXRpb24+CiAgICAgIDwvcmRmOkRlc2NyaXB0aW9uPgogICA8L3JkZjpSREY+CjwveDp4bXBtZXRhPgpMwidZAAAAsElEQVR4Ae3ZMQoAIAgFUL3/ocsO0GBLFE9wESJ8jj8jYlQrAgQIECBAgAABAgQIECBAgAABAgQIECBAgACBbwWyNutGQuuNIkCAAAECBAgQIECAAAECBAgQIECAAAECBAgQeEbgJBLaLScq2smYEyBAgAABAgQIECBAgAABAgQIECBAgAABAgSuCpxEQqKfqyfzOQECBAgQIECAAAECBAgQIECAAAECBAgQIECgKzABwWUEBHBCyqYAAAAASUVORK5CYII=)}.aside-x4.svelte-1ebb1rm.svelte-1ebb1rm{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABYAAADwCAYAAAAEqZSkAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAeGVYSWZNTQAqAAAACAAEARIAAwAAAAEAAQAAARoABQAAAAEAAAA+ARsABQAAAAEAAABGh2kABAAAAAEAAABOAAAAAAAAAEgAAAABAAAASAAAAAEAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAFqADAAQAAAABAAAA8AAAAABUK6+SAAAACXBIWXMAAAsTAAALEwEAmpwYAAACMWlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iWE1QIENvcmUgNS40LjAiPgogICA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPgogICAgICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIgogICAgICAgICAgICB4bWxuczp0aWZmPSJodHRwOi8vbnMuYWRvYmUuY29tL3RpZmYvMS4wLyIKICAgICAgICAgICAgeG1sbnM6ZXhpZj0iaHR0cDovL25zLmFkb2JlLmNvbS9leGlmLzEuMC8iPgogICAgICAgICA8dGlmZjpPcmllbnRhdGlvbj4xPC90aWZmOk9yaWVudGF0aW9uPgogICAgICAgICA8ZXhpZjpDb2xvclNwYWNlPjE8L2V4aWY6Q29sb3JTcGFjZT4KICAgICAgICAgPGV4aWY6UGl4ZWxYRGltZW5zaW9uPjIyPC9leGlmOlBpeGVsWERpbWVuc2lvbj4KICAgICAgICAgPGV4aWY6UGl4ZWxZRGltZW5zaW9uPjMwMDwvZXhpZjpQaXhlbFlEaW1lbnNpb24+CiAgICAgIDwvcmRmOkRlc2NyaXB0aW9uPgogICA8L3JkZjpSREY+CjwveDp4bXBtZXRhPgrL2/xqAAAA2klEQVR4Ae3bMQqEMBBA0QT2Bh7G+5d2e5G9wRZruliM6CCBsE8QQghxeOUHaynlvb/zPHUf9TXPuCYlQIAAAQIECBAgQIAAAQIECBAg8N8CLegtNwk+V863i7crB7sza7cev8y0ze/4MX2RAAECBAgQIECAAAECBAgQIECAAIEmkGmbkdyheWbaZnTxmOaZaZvRxJpnJGOfAAECBAgQIECAAAECBAgQIECAwEMCmbZ5aJjRHJm2OaZhnk189590DTPStE+AAAECBAgQIECAAAECBAgQIEBgVoEfgLcJ4JWKwMAAAAAASUVORK5CYII=)}.aside-x3.svelte-1ebb1rm.svelte-1ebb1rm{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABYAAAC0CAYAAACQYNzeAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAeGVYSWZNTQAqAAAACAAEARIAAwAAAAEAAQAAARoABQAAAAEAAAA+ARsABQAAAAEAAABGh2kABAAAAAEAAABOAAAAAAAAAEgAAAABAAAASAAAAAEAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAFqADAAQAAAABAAAAtAAAAAD5WFEbAAAACXBIWXMAAAsTAAALEwEAmpwYAAACMWlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iWE1QIENvcmUgNS40LjAiPgogICA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPgogICAgICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIgogICAgICAgICAgICB4bWxuczp0aWZmPSJodHRwOi8vbnMuYWRvYmUuY29tL3RpZmYvMS4wLyIKICAgICAgICAgICAgeG1sbnM6ZXhpZj0iaHR0cDovL25zLmFkb2JlLmNvbS9leGlmLzEuMC8iPgogICAgICAgICA8dGlmZjpPcmllbnRhdGlvbj4xPC90aWZmOk9yaWVudGF0aW9uPgogICAgICAgICA8ZXhpZjpDb2xvclNwYWNlPjE8L2V4aWY6Q29sb3JTcGFjZT4KICAgICAgICAgPGV4aWY6UGl4ZWxYRGltZW5zaW9uPjIyPC9leGlmOlBpeGVsWERpbWVuc2lvbj4KICAgICAgICAgPGV4aWY6UGl4ZWxZRGltZW5zaW9uPjMwMDwvZXhpZjpQaXhlbFlEaW1lbnNpb24+CiAgICAgIDwvcmRmOkRlc2NyaXB0aW9uPgogICA8L3JkZjpSREY+CjwveDp4bXBtZXRhPgrL2/xqAAAA6UlEQVRoBe3XQQrCQAwF0Bb0Hr2heB4v14MIOtmli8GmlFHhBQbimA7h7f48TdOjnf+pua16/Z91bUqAAAECBAgQIECAAAECHwQi58Wp1KsyfPpsbLsUX133zF/a0G3PYJq5p358GxSxdaWelWGzBAgQIECAAAECBAgQIDBUIHJenDNqTHiPbZcz1m1vrPmdIyE9f5/7MeE9KKohPW+Ze+E9a+gJECBAgAABAgQIECDwHYHIeXEqNSaM9zaKbZfen537tXO/uT4S0seE8c2a6UdQVEO6MJ4AtQQIECBAgAABAgQIECDwqwJv9lMMWDcoNMAAAAAASUVORK5CYII=)}.aside-x2.svelte-1ebb1rm.svelte-1ebb1rm{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABYAAAB4CAYAAAD2SgIRAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAeGVYSWZNTQAqAAAACAAEARIAAwAAAAEAAQAAARoABQAAAAEAAAA+ARsABQAAAAEAAABGh2kABAAAAAEAAABOAAAAAAAAAEgAAAABAAAASAAAAAEAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAFqADAAQAAAABAAAAeAAAAADVvVTBAAAACXBIWXMAAAsTAAALEwEAmpwYAAACMWlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iWE1QIENvcmUgNS40LjAiPgogICA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPgogICAgICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIgogICAgICAgICAgICB4bWxuczp0aWZmPSJodHRwOi8vbnMuYWRvYmUuY29tL3RpZmYvMS4wLyIKICAgICAgICAgICAgeG1sbnM6ZXhpZj0iaHR0cDovL25zLmFkb2JlLmNvbS9leGlmLzEuMC8iPgogICAgICAgICA8dGlmZjpPcmllbnRhdGlvbj4xPC90aWZmOk9yaWVudGF0aW9uPgogICAgICAgICA8ZXhpZjpDb2xvclNwYWNlPjE8L2V4aWY6Q29sb3JTcGFjZT4KICAgICAgICAgPGV4aWY6UGl4ZWxYRGltZW5zaW9uPjIyPC9leGlmOlBpeGVsWERpbWVuc2lvbj4KICAgICAgICAgPGV4aWY6UGl4ZWxZRGltZW5zaW9uPjMwMDwvZXhpZjpQaXhlbFlEaW1lbnNpb24+CiAgICAgIDwvcmRmOkRlc2NyaXB0aW9uPgogICA8L3JkZjpSREY+CjwveDp4bXBtZXRhPgrL2/xqAAAAt0lEQVRoBe3YMQqAMAyF4VYUD+Ii7p7JK7t4EkVsnOoSEtql+AuC2GdIPxxCYwhhS3c7V0ytju20S6cIIIAAAggg8EcBGVh658YvZ75uXDqenSV3S14YFkswy5gKZ3keEUAAAQQQQACBnwnI7NZV2vNdqY5eRjqe9Ih59ciTMm2u+YuC50/hgjr6p0Ix6BHz6mlOEkQAAQQQQAABBBwCMrBwtvmCcbbp+G+IIoAAAggggAACCDgFHqn/Cpqy3VM1AAAAAElFTkSuQmCC)}.aside-x1.svelte-1ebb1rm.svelte-1ebb1rm{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABYAAAA8CAYAAABig0prAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAeGVYSWZNTQAqAAAACAAEARIAAwAAAAEAAQAAARoABQAAAAEAAAA+ARsABQAAAAEAAABGh2kABAAAAAEAAABOAAAAAAAAAEgAAAABAAAASAAAAAEAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAFqADAAQAAAABAAAAPAAAAAB4zqpIAAAACXBIWXMAAAsTAAALEwEAmpwYAAACMWlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iWE1QIENvcmUgNS40LjAiPgogICA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPgogICAgICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIgogICAgICAgICAgICB4bWxuczp0aWZmPSJodHRwOi8vbnMuYWRvYmUuY29tL3RpZmYvMS4wLyIKICAgICAgICAgICAgeG1sbnM6ZXhpZj0iaHR0cDovL25zLmFkb2JlLmNvbS9leGlmLzEuMC8iPgogICAgICAgICA8dGlmZjpPcmllbnRhdGlvbj4xPC90aWZmOk9yaWVudGF0aW9uPgogICAgICAgICA8ZXhpZjpDb2xvclNwYWNlPjE8L2V4aWY6Q29sb3JTcGFjZT4KICAgICAgICAgPGV4aWY6UGl4ZWxYRGltZW5zaW9uPjIyPC9leGlmOlBpeGVsWERpbWVuc2lvbj4KICAgICAgICAgPGV4aWY6UGl4ZWxZRGltZW5zaW9uPjMwMDwvZXhpZjpQaXhlbFlEaW1lbnNpb24+CiAgICAgIDwvcmRmOkRlc2NyaXB0aW9uPgogICA8L3JkZjpSREY+CjwveDp4bXBtZXRhPgrL2/xqAAAArElEQVRYCe2VSwqAMAxEW3WjK3eCHsT7H0bBQ/jp7LqokIQirUyhUMIkJA8y9c65Ndx6jg+tdvW0y05J4CcEsHmtcpZTqc8rR8eLsuQm0cOAeomwGA1Q4GrOrRFTSwIkkCCArWsScUvosiSpc9DxrM5KJ+xxGLY5xIHi3xbbfBuKdvpGhnESqJ8AvGJSjnFI9LDNUSKMNKLCkT7v0/LnffO35Z2T1UiABAol8ACZ6QleECm8BQAAAABJRU5ErkJggg==)}.aside__line.svelte-1ebb1rm.svelte-1ebb1rm{position:absolute;left:65px;transform:translateX(-50%);width:4px;height:100%;background:var(--text-accent)}.filled.svelte-1ebb1rm.svelte-1ebb1rm{transform-origin:top center;z-index:1;animation:scaleDown 1s ease-in-out;animation-fill-mode:forwards}.filled__line__completed.svelte-1ebb1rm.svelte-1ebb1rm{position:absolute;top:0;left:0;width:100%}.events.svelte-1ebb1rm.svelte-1ebb1rm{position:relative;padding-bottom:50px}.event_item.svelte-1ebb1rm.svelte-1ebb1rm{border-bottom:2px solid var(--background-primary);margin:0;cursor:pointer;padding:5px 10px 10px 0;width:100%;overflow:hidden}.event_item.short.svelte-1ebb1rm.svelte-1ebb1rm{padding:0}.event_item.svelte-1ebb1rm.svelte-1ebb1rm:hover{background-color:var(--interactive-accent-hover);box-shadow:0px 0px 52px -18px rgba(0, 0, 0, 0.75)}.event_item_color1.svelte-1ebb1rm.svelte-1ebb1rm{background-color:var(--skobeloff)}.event_item_color2.svelte-1ebb1rm.svelte-1ebb1rm{background-color:var(--midnight-green-eagle-green)}.event_item_color3.svelte-1ebb1rm.svelte-1ebb1rm{background-color:var(--midnight-green-eagle-green-2)}.event_item_color4.svelte-1ebb1rm.svelte-1ebb1rm{background-color:var(--midnight-green-eagle-green-3)}.event_item_color5.svelte-1ebb1rm.svelte-1ebb1rm{background-color:var(--charcoal)}.event_item_color6.svelte-1ebb1rm.svelte-1ebb1rm{background-color:var(--prussian-blue)}.event_item_color7.svelte-1ebb1rm.svelte-1ebb1rm{background-color:var(--space-cadet)}.event_item_color8.svelte-1ebb1rm.svelte-1ebb1rm{background-color:var(--dark-purple)}.event_item_color9.svelte-1ebb1rm.svelte-1ebb1rm{background-color:var(--russian-violet)}.event_item_color10.svelte-1ebb1rm.svelte-1ebb1rm{background-color:var(--russian-violet-2)}.event_item_contents.svelte-1ebb1rm.svelte-1ebb1rm{padding-left:58px}.ei_Copy.svelte-1ebb1rm.svelte-1ebb1rm,.ei_Title.svelte-1ebb1rm.svelte-1ebb1rm{color:var(--text-on-accent)}.ei_Dot.svelte-1ebb1rm.svelte-1ebb1rm,.ei_Title.svelte-1ebb1rm.svelte-1ebb1rm{display:inline-block}.ei_Dot.svelte-1ebb1rm.svelte-1ebb1rm{position:absolute;border-radius:50%;width:14px;height:14px;margin-top:5px;background-color:var(--text-accent);box-shadow:0px 0px 52px -18px rgba(0, 0, 0, 0.75);z-index:2}.dot_active.svelte-1ebb1rm.svelte-1ebb1rm{background-color:var(--text-error-hover)}.ei_Title.svelte-1ebb1rm.svelte-1ebb1rm{margin-left:26px}.ei_Copy.svelte-1ebb1rm.svelte-1ebb1rm{font-size:15px;display:inline-block;margin-left:28px}.header_title.svelte-1ebb1rm.svelte-1ebb1rm,.ei_Title.svelte-1ebb1rm.svelte-1ebb1rm,.ce_title.svelte-1ebb1rm.svelte-1ebb1rm{color:#fff}#now-line.svelte-1ebb1rm.svelte-1ebb1rm{height:4px;background-color:darkred;opacity:80%;position:absolute;z-index:3;width:100%}#now-line.svelte-1ebb1rm .timeline-time.svelte-1ebb1rm{position:relative;left:5px;top:0;background-color:darkred;color:#fff;padding:0 4px 2px 4px;border-radius:0 0 4px 4px;text-align:center}#scroll-controls.svelte-1ebb1rm.svelte-1ebb1rm{background-color:var(--background-secondary);position:sticky;bottom:0;width:100%;z-index:4;padding:8px 15px;text-align:center;height:45px}#scroll-controls.svelte-1ebb1rm label.svelte-1ebb1rm{display:block;float:left;margin:2px}#scroll-controls.svelte-1ebb1rm .toggle.svelte-1ebb1rm{-webkit-appearance:none;-moz-appearance:none;appearance:none;width:50px;height:20px;display:block;float:left;position:relative;margin-top:5px;border-radius:50px;overflow:hidden;outline:none;border:none;cursor:pointer;background-color:var(--background-secondary-alt);transition:background-color ease 0.3s}#scroll-controls.svelte-1ebb1rm .toggle.svelte-1ebb1rm:before{content:"on    ";display:block;position:absolute;z-index:2;width:17px;height:17px;background:#fff;left:2px;top:1px;border-radius:50%;font:9px/18px Helvetica;text-transform:uppercase;font-weight:bold;text-indent:-24px;word-spacing:30px;color:#fff;text-shadow:-1px -1px rgba(0,0,0,0.15);white-space:nowrap;box-shadow:0 1px 2px rgba(0,0,0,0.2);transition:all cubic-bezier(0.3, 1.5, 0.7, 1) 0.3s}#scroll-controls.svelte-1ebb1rm .toggle.svelte-1ebb1rm:checked{background-color:var(--interactive-accent)}#scroll-controls.svelte-1ebb1rm .toggle.svelte-1ebb1rm:checked:before{left:31px}#scroll-controls.svelte-1ebb1rm input[type=checkbox].svelte-1ebb1rm:checked:after{background-color:transparent}.empty-timeline.svelte-1ebb1rm.svelte-1ebb1rm{text-align:center;vertical-align:middle;margin-top:50%}')}function kt(n,e,t){let s=n.slice();return s[19]=e[t],s[21]=t,s}function kn(n){let e;return{c(){e=E("div"),e.textContent="No Planner Data",g(e,"class","empty-timeline svelte-1ebb1rm")},m(t,s){fe(t,e,s)},p:k,d(t){t&&X(e)}}}function In(n){let e,t,s,i,r,o,l,c,a,p,A=n[6](n[4]).format("HH:mm")+"",_,v,h,b,d,m,T,S,L=n[0].items,C=[];for(let u=0;u<L.length;u+=1)C[u]=It(kt(n,L,u));return{c(){e=E("div"),t=E("div"),s=E("div"),i=E("div"),o=R(),l=E("div");for(let u=0;u<C.length;u+=1)C[u].c();c=R(),a=E("div"),p=E("span"),_=J(A),v=R(),h=E("div"),b=E("label"),b.textContent="Track time",d=R(),m=E("input"),g(i,"class","filled__line__completed svelte-1ebb1rm"),F(i,"height",ge+"px"),g(s,"class","aside__line filled__line svelte-1ebb1rm"),g(t,"class",r="aside aside-x"+n[1]+" filled svelte-1ebb1rm"),F(t,"top",n[3]+"px"),g(l,"class","events svelte-1ebb1rm"),g(p,"class","timeline-time svelte-1ebb1rm"),g(a,"id","now-line"),F(a,"top",n[2]+"px"),F(a,"display",n[0].current&&!n[0].current.isEnd?"block":"none"),g(a,"class","svelte-1ebb1rm"),g(b,"for","auto-scroll"),g(b,"class","svelte-1ebb1rm"),g(m,"id","auto-scroll"),g(m,"type","checkbox"),g(m,"class","toggle svelte-1ebb1rm"),g(h,"id","scroll-controls"),g(h,"class","svelte-1ebb1rm"),g(e,"id","day-planner-timeline-container"),g(e,"class","svelte-1ebb1rm")},m(u,x){fe(u,e,x),y(e,t),y(t,s),y(s,i),y(e,o),y(e,l);for(let P=0;P<C.length;P+=1)C[P]&&C[P].m(l,null);y(e,c),y(e,a),y(a,p),y(p,_),y(e,v),y(e,h),y(h,b),y(h,d),y(h,m),m.checked=n[5],T||(S=Et(m,"change",n[9]),T=!0)},p(u,x){if(x&2&&r!==(r="aside aside-x"+u[1]+" filled svelte-1ebb1rm")&&g(t,"class",r),x&8&&F(t,"top",u[3]+"px"),x&131){L=u[0].items;let P;for(P=0;P<L.length;P+=1){let He=kt(u,L,P);C[P]?C[P].p(He,x):(C[P]=It(He),C[P].c(),C[P].m(l,null))}for(;P<C.length;P+=1)C[P].d(1);C.length=L.length}x&16&&A!==(A=u[6](u[4]).format("HH:mm")+"")&&xe(_,A),x&4&&F(a,"top",u[2]+"px"),x&1&&F(a,"display",u[0].current&&!u[0].current.isEnd?"block":"none"),x&32&&(m.checked=u[5])},d(u){u&&X(e),wt(C,u),T=!1,S()}}}function It(n){let e,t,s,i,r,o,l=n[19].rawTime+"",c,a,p,A=(n[19].text??"")+"",_,v,h,b;return{c(){e=E("div"),t=E("div"),s=E("div"),r=R(),o=E("div"),c=J(l),a=R(),p=E("div"),_=J(A),v=R(),g(s,"class",i="ei_Dot "+(n[19]===n[0].current?"dot_active":"")+" svelte-1ebb1rm"),g(o,"class","ei_Title svelte-1ebb1rm"),g(p,"class","ei_Copy svelte-1ebb1rm"),g(t,"class","event_item_contents svelte-1ebb1rm"),g(e,"class",h="event_item event_item_color"+(n[21]%10+1)+" "+n[7](n[19])+" "+Ft(n[19])+" svelte-1ebb1rm"),F(e,"height",n[19].durationMins*n[1]+"px"),g(e,"data-title",b=n[19].rawTime)},m(d,m){fe(d,e,m),y(e,t),y(t,s),y(t,r),y(t,o),y(o,c),y(t,a),y(t,p),y(p,_),y(e,v)},p(d,m){m&1&&i!==(i="ei_Dot "+(d[19]===d[0].current?"dot_active":"")+" svelte-1ebb1rm")&&g(s,"class",i),m&1&&l!==(l=d[19].rawTime+"")&&xe(c,l),m&1&&A!==(A=(d[19].text??"")+"")&&xe(_,A),m&1&&h!==(h="event_item event_item_color"+(d[21]%10+1)+" "+d[7](d[19])+" "+Ft(d[19])+" svelte-1ebb1rm")&&g(e,"class",h),m&3&&F(e,"height",d[19].durationMins*d[1]+"px"),m&1&&b!==(b=d[19].rawTime)&&g(e,"data-title",b)},d(d){d&&X(e)}}}function Fn(n){let e;function t(r,o){return r[0].items.length>0?In:kn}let s=t(n,-1),i=s(n);return{c(){i.c(),e=vt()},m(r,o){i.m(r,o),fe(r,e,o)},p(r,[o]){s===(s=t(r,o))&&i?i.p(r,o):(i.d(1),i=s(r),i&&(i.c(),i.m(e.parentNode,e)))},i:k,o:k,d(r){i.d(r),r&&X(e)}}}function Ft(n){return n.isPast?"past":""}function Tn(n,e,t){let s=window.moment,{summary:i}=e,{rootEl:r}=e,o,l,c,a,p=!0,A=Ae.subscribe(u=>{t(0,i=u),S()}),_=ge.subscribe(u=>{t(2,l=u)}),v=ke.subscribe(u=>{t(4,a=u),T(l-150),o||t(1,o=4)}),h=Ie.subscribe(u=>{t(1,o=u)});O(A),O(_),O(v),O(h),O(d),ze(()=>{b()});function b(){r.addEventListener("scroll",m)}function d(){r.removeEventListener("scroll",m)}function m(u){t(5,p=!1)}function T(u){var x;p&&!(!((x=i.current)===null||x===void 0)&&x.isEnd)&&(d(),r.scrollTo({left:0,top:u,behavior:"smooth"}),setTimeout(b,1e3))}function S(){t(3,c=i.empty?0:i.items.first().time.getMinutes()*o*-1-1)}function L(u){return u.durationMins<75/o?"short":""}function C(){p=this.checked,t(5,p)}return n.$$set=u=>{"summary"in u&&t(0,i=u.summary),"rootEl"in u&&t(8,r=u.rootEl)},[i,o,l,c,a,p,s,L,r,C]}var Ve=class extends Pe{constructor(e){super(),xt(this,e,Tn,Fn,De,{summary:0,rootEl:8},xn)}},Tt=Ve;var Nt=window.moment,he=class extends Bt.ItemView{constructor(t,s){super(t);this.settings=s}getViewType(){return $}getDisplayText(){return"Day Planner Timeline"}getIcon(){return this.settings.timelineIcon}update(t){Ae.update(r=>r=t);let s=new Date;ke.update(r=>r=s);let i=t.empty?0:this.positionFromTime(s)-this.positionFromTime(t.items.first().time);ge.update(r=>r=i),Ie.update(r=>r=this.settings.timelineZoomLevel)}positionFromTime(t){return Nt.duration(Nt(t).format("HH:mm")).asMinutes()*this.settings.timelineZoomLevel}async onOpen(){this.timeline=new Tt({target:this.contentEl,props:{planSummary:Ae,rootEl:this.containerEl.children[1]}})}};var Lt=Xe(Ye()),Fe=class extends St.Plugin{constructor(){super(...arguments);this.codeMirror=t=>{this.file.hasTodayNote()&&this.plannerMD.checkIsDayPlannerEditing()}}get syncPlugin(){return this.app.internalPlugins.getPluginById("sync")}async onload(){console.log("Loading Day Planner plugin v"+this.manifest.version),this.vault=this.app.vault,this.settings=Object.assign(new ye,await this.loadData()),this.notesForDatesQuery=new M,this.file=new le(this.vault,this.settings);let t=this.syncPlugin?.instance!=null;this.device=t?this.syncPlugin.instance.deviceName.length>0?this.syncPlugin.instance.deviceName:this.syncPlugin.instance.getDefaultDeviceName():"Unknown",console.debug("DPOG: Device/Writer:",this.settings.mode,this.device,this.settings.writer,this.isWriter());let s=new ee;this.parser=new ce(this.settings),this.plannerMD=new Z(this.app.workspace,this.settings,this.file,this.parser,s),this.statusBar=new K(this.settings,this.addStatusBarItem(),this.app.workspace,s,new Z(this.app.workspace,this.settings,this.file,this.parser,s),this.file),this.statusBar.initStatusBar(),this.registerEvent(this.app.vault.on("modify",this.codeMirror,"")),this.addCommand({id:"app:add-to-note",name:"Add a Day Planner template for today to the current note",callback:()=>this.modeGuard(async()=>await this.insertDayPlannerIntoCurrentNote(!0)),hotkeys:[]}),this.addCommand({id:"app:link-to-note",name:"Link today's Day Planner to the current note",callback:()=>this.modeGuard(async()=>await this.insertDayPlannerIntoCurrentNote(!1)),hotkeys:[]}),this.addCommand({id:"app:unlink-from-note",name:"Unlink today's Day Planner from its note",callback:()=>this.modeGuard(async()=>await this.unlinkDayPlanner()),hotkeys:[]}),this.addCommand({id:"app:show-timeline",name:"Show the Day Planner Timeline",callback:()=>this.initLeaf(),hotkeys:[]}),this.addCommand({id:"app:show-today-note",name:"Show today's Day Planner",callback:()=>this.app.workspace.openLinkText(this.file.todayPlannerFilePath(),"",!0),hotkeys:[]}),this.addCommand({id:"app:set-as-writer",name:`Set current device '${this.device}' as writer`,callback:async()=>{this.settings.writer=this.device,this.save()},hotkeys:[]}),this.registerView($,i=>this.timelineView=new he(i,this.settings)),this.addSettingTab(new we(this.app,this)),this.setTicker()}async onunload(){this.interval&&(console.debug("DPOG: Clearing ticker"),window.clearInterval(this.interval))}async handleConfigFileChange(){await super.handleConfigFileChange(),this.settings=Object.assign(this.settings,await this.loadData()),this.parser.updateSettings(this.settings);let t=await this.file.hasTodayNote();console.log("DPOG: update Device/Writer:",this.settings.mode,this.device,this.settings.writer,this.isWriter(),t)}isWriter(){return this.device==="Unknown"||!this.settings.writer||this.settings.writer===this.device}setTicker(){this.interval&&(console.debug("DPOG: Clearing ticker"),window.clearInterval(this.interval),this.interval=void 0),console.log("DPOG: set Ticker with Device/Writer:",this.device,this.settings.writer,this.isWriter()),this.interval=window.setInterval(()=>this.tick(),2e3)}async tick(){try{if(await this.file.hasTodayNote()){let t=await this.plannerMD.processDayPlanner(this.isWriter());await this.statusBar.refreshStatusBar(t),this.timelineView&&this.timelineView.update(t)}else if(this.settings.mode==2&&(0,Lt.appHasDailyNotesPluginLoaded)()){let t=new B([],this.isWriter());await this.statusBar.refreshStatusBar(t),this.timelineView&&this.timelineView.update(t)}}catch(t){console.log(t)}}initLeaf(){this.app.workspace.getLeavesOfType($).length>0||this.app.workspace.getRightLeaf(!0).setViewState({type:$})}modeGuard(t){if(this.settings.mode!==1){new Notification("Day Planner plugin in File mode",{silent:!0,body:"Switch to Command mode in settings to use this command"});return}else t()}async insertDayPlannerIntoCurrentNote(t){try{let i=this.app.workspace.activeLeaf.view.getState().file,r=this.notesForDatesQuery.exists(this.settings.notesToDates),o=this.notesForDatesQuery.active(this.settings.notesToDates)?.notePath;if(this.settings.notesToDates=this.settings.notesToDates||[],r&&o!==i){new Notification("Day Planner exists",{silent:!0,body:`A Day Planner for today already exists in ${o}`});return}else r?this.settings.notesToDates||(this.settings.notesToDates=[]):this.settings.notesToDates=[new Y(i,new Date().toDateString())];await this.save(),t&&this.plannerMD.insertPlanner()}catch(s){console.error(s)}}async unlinkDayPlanner(){try{let t=this.notesForDatesQuery.active(this.settings.notesToDates);if(!t){new Notification("No Day Planner found",{silent:!0,body:"No Day Planner found for today"});return}this.settings.notesToDates=this.settings.notesToDates||[],this.settings.notesToDates.remove(t),await this.save(),this.statusBar.hide(this.statusBar.statusBar),this.timelineView&&this.timelineView.update(new B([],this.isWriter())),new Notification("Day Planner reset",{silent:!0,body:`The Day Planner for today has been dissociated from ${t.notePath} and can be added to another note`})}catch(t){console.error(t)}}async save(){await this.saveData(this.settings)}};
